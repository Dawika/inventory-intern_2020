(function() {
	angular.module('somsri.somsri.update_inventory_request_step3', [])
    .controller('updateInventoryRequestStep3Ctrl', ['$compile', '$scope', '$window', '$filter', '$rootScope', '$timeout', 'translateFilter', '$uibModal', 'Upload', '$state', "inventoryRequestService" , function($compile, $scope, $window, $filter, $rootScope, $timeout, translateFilter, $uibModal, Upload, $state, service) {
	$rootScope.menu = translateFilter("inventory_request")
		var ctrl = this
		ctrl.real_id = $state.params.id;

		ctrl.date_get_inventory = ""
		ctrl.buy_slip = ""
		ctrl.end_warranty = ""

		function checkStep() {
			ctrl.step = $rootScope.step
			if(!ctrl.step) {
				if (ctrl.real_id) {
					$rootScope.updateInventoryRequest(ctrl.real_id)
				}
			} else {
				ctrl.save_by_step2 = ctrl.step.step2.save_by
				ctrl.date_purchase = $filter('date')(new Date(ctrl.step.step2.date_purchasing), 'dd/MM/yyyy')
				ctrl.date_send = $filter('date')(new Date(ctrl.step.step2.date_send), 'dd/MM/yyyy')
				ctrl.price_step2 = ctrl.step.step2.price
				//
				ctrl.save_by_step3 = ctrl.step.step3.save_by
				ctrl.date_get_inventory = ctrl.step.step3.get_date
				ctrl.buy_slip = ctrl.step.step3.buy_slip
				ctrl.end_warranty = ctrl.step.step3.end_warranty
			}
			console.log("step3",ctrl.step)
		}

		checkStep()

		 ctrl.continue = function() {
    	ctrl.step.step3.get_date = ctrl.date_get_inventory
    	ctrl.step.step3.buy_slip = ctrl.buy_slip
    	ctrl.step.step3.end_warranty = ctrl.end_warranty
    	ctrl.step.step3.save_by = "Admin"
    	$rootScope.updateInventoryRequestStep4(ctrl.step, ctrl.real_id)
    }

    ctrl.opengetInventorytDatePopup = function() {
      ctrl.getInventoryDatePopup.opened = true;
    };

    ctrl.getInventoryDatePopup = {
      opened: false
    }; 


    ctrl.openEndwarrantytDatePopup = function() {
      ctrl.endWarrantyDatePopup.opened = true;
    };

    ctrl.endWarrantyDatePopup = {
      opened: false
    };
	}]);
})();