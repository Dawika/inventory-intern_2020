(function() {
  'use strict';
  angular.module('somsri.payroll.main', [
  ])
  .controller('mainCtrl', ['$rootScope', '$state', '$scope', '$uibModal', function($rootScope, $state, $scope, $uibModal) {
    $rootScope.openReport = function() {
      $state.go('report')
    };

    $rootScope.openEmployees = function () {
      $state.go('employees')
    };

    $rootScope.openPayroll = function () {
      $state.go('payroll')
    };

    $rootScope.openSetting = function () {
      $state.go('setting')
    };

    $rootScope.openEmployeeDetails = function (id) {
      $state.go('employee_details',{ id: id });
    };

    $rootScope.openSlip = function (id, payroll_id) {
      if(payroll_id){
        $state.go('slip',{ id: id, payroll_id: payroll_id });
      }else{
        $state.go('slip',{ id: id });
      }

    };

    $rootScope.openConfirmationModal = function (message, success, dismiss) {
      $scope.message = message;
      $uibModal.open({
        animation: true,
        backdrop: 'static',
        keyboard: false,
        scope: $scope,
        templateUrl: "<%= asset_path('angular/components/modal/confirm/confirmModalView.html') %>",
        controller: 'confirmModalCtrl as confirm',
        size: 'md',
        resolve: {
          resources: ['$ocLazyLoad', 'ASSETS', function($ocLazyLoad, ASSETS) {
            return $ocLazyLoad.load([
              ASSETS.somsri.payroll.confirm_modal
            ]);
          }]
        }
      }).result.then(function (isConfirm) {
        if (isConfirm) {
          if(success){ success() }
        }else{
          if(dismiss){ dismiss() }
        }
      });
    }

  }]);
})();
